<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 8 Analyse de covariance (ANCOVA) | Modèle linéaire général et modèle linéaire généralisé</title>
  <meta name="description" content="Chapitre 8 Analyse de covariance (ANCOVA) | Modèle linéaire général et modèle linéaire généralisé" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 8 Analyse de covariance (ANCOVA) | Modèle linéaire général et modèle linéaire généralisé" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 8 Analyse de covariance (ANCOVA) | Modèle linéaire général et modèle linéaire généralisé" />
  
  
  

<meta name="author" content="Cathy Maugis-Rabusseau (INSA Toulouse / IMT)" />


<meta name="date" content="2021-10-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ANOVA.html"/>
<link rel="next" href="GLM.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">UF Elements de modélisation statistique</a></li>
<li>      <img src="image/LogoInsaToulouse.jpg" height="20px" align="right"/>      </li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#modélisation-dune-réponse-quantitative"><i class="fa fa-check"></i><b>1.1</b> Modélisation d’une réponse quantitative</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#jeu-de-données-illustratif"><i class="fa fa-check"></i><b>1.1.1</b> Jeu de données illustratif</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#régression-linéaire"><i class="fa fa-check"></i><b>1.1.2</b> Régression linéaire</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#analyse-de-la-variance-anova"><i class="fa fa-check"></i><b>1.1.3</b> Analyse de la variance (ANOVA)</a></li>
<li class="chapter" data-level="1.1.4" data-path="intro.html"><a href="intro.html#analyse-de-covariance-ancova"><i class="fa fa-check"></i><b>1.1.4</b> Analyse de covariance (ANCOVA)</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#modélisation-dune-variable-binaire-de-comptage"><i class="fa fa-check"></i><b>1.2</b> Modélisation d’une variable binaire, de comptage, …</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#objectifs-du-cours"><i class="fa fa-check"></i><b>1.3</b> Objectifs du cours</a></li>
</ul></li>
<li class="part"><span><b>I Le modèle linéaire général</b></span></li>
<li class="chapter" data-level="2" data-path="DefML.html"><a href="DefML.html"><i class="fa fa-check"></i><b>2</b> Définitions générales</a><ul>
<li class="chapter" data-level="2.1" data-path="DefML.html"><a href="DefML.html#modlinreg"><i class="fa fa-check"></i><b>2.1</b> Modèle linéaire régulier</a></li>
<li class="chapter" data-level="2.2" data-path="DefML.html"><a href="DefML.html#exemples-de-modèle-linéaire-gaussien"><i class="fa fa-check"></i><b>2.2</b> Exemples de modèle linéaire gaussien</a><ul>
<li class="chapter" data-level="2.2.1" data-path="DefML.html"><a href="DefML.html#le-modèle-de-régression-linéaire"><i class="fa fa-check"></i><b>2.2.1</b> Le modèle de régression linéaire</a></li>
<li class="chapter" data-level="2.2.2" data-path="DefML.html"><a href="DefML.html#le-modèle-danalyse-de-la-variance"><i class="fa fa-check"></i><b>2.2.2</b> Le modèle d’analyse de la variance</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="DefML.html"><a href="DefML.html#en-résumé"><i class="fa fa-check"></i><b>2.3</b> En résumé</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="EstML.html"><a href="EstML.html"><i class="fa fa-check"></i><b>3</b> Estimation des paramètres</a><ul>
<li class="chapter" data-level="3.1" data-path="EstML.html"><a href="EstML.html#estimation-de-theta"><i class="fa fa-check"></i><b>3.1</b> Estimation de <span class="math inline">\(\theta\)</span></a></li>
<li class="chapter" data-level="3.2" data-path="EstML.html"><a href="EstML.html#valeurs-ajustées-et-résidus"><i class="fa fa-check"></i><b>3.2</b> Valeurs ajustées et résidus</a></li>
<li class="chapter" data-level="3.3" data-path="EstML.html"><a href="EstML.html#estimation-de-sigma2"><i class="fa fa-check"></i><b>3.3</b> Estimation de <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="3.4" data-path="EstML.html"><a href="EstML.html#erreurs-standards"><i class="fa fa-check"></i><b>3.4</b> Erreurs standards</a></li>
<li class="chapter" data-level="3.5" data-path="EstML.html"><a href="EstML.html#intervalle-de-confiance-de-theta_j-de-xtheta_i-et-de-x_0theta"><i class="fa fa-check"></i><b>3.5</b> Intervalle de confiance de <span class="math inline">\(\theta_j\)</span>, de <span class="math inline">\((X\theta)_i\)</span> et de <span class="math inline">\(X_0\theta\)</span></a><ul>
<li class="chapter" data-level="3.5.1" data-path="EstML.html"><a href="EstML.html#ICthetaj"><i class="fa fa-check"></i><b>3.5.1</b> Intervalle de confiance de <span class="math inline">\(\theta_j\)</span></a></li>
<li class="chapter" data-level="3.5.2" data-path="EstML.html"><a href="EstML.html#ICXthetai"><i class="fa fa-check"></i><b>3.5.2</b> Intervalle de confiance de <span class="math inline">\((X\theta)_i\)</span></a></li>
<li class="chapter" data-level="3.5.3" data-path="EstML.html"><a href="EstML.html#ICX0theta"><i class="fa fa-check"></i><b>3.5.3</b> Intervalle de confiance de <span class="math inline">\(X_0\theta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="EstML.html"><a href="EstML.html#ICpredit"><i class="fa fa-check"></i><b>3.6</b> Intervalles de prédiction</a></li>
<li class="chapter" data-level="3.7" data-path="EstML.html"><a href="EstML.html#qualité-dajustement"><i class="fa fa-check"></i><b>3.7</b> Qualité d’ajustement</a></li>
<li class="chapter" data-level="3.8" data-path="EstML.html"><a href="EstML.html#en-résumé-1"><i class="fa fa-check"></i><b>3.8</b> En résumé</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Test.html"><a href="Test.html"><i class="fa fa-check"></i><b>4</b> Test de Fisher-Snedecor</a><ul>
<li class="chapter" data-level="4.1" data-path="Test.html"><a href="Test.html#hypothèses-testées"><i class="fa fa-check"></i><b>4.1</b> Hypothèses testées</a><ul>
<li class="chapter" data-level="4.1.1" data-path="Test.html"><a href="Test.html#première-écriture"><i class="fa fa-check"></i><b>4.1.1</b> Première écriture</a></li>
<li class="chapter" data-level="4.1.2" data-path="Test.html"><a href="Test.html#seconde-écriture"><i class="fa fa-check"></i><b>4.1.2</b> Seconde écriture</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="Test.html"><a href="Test.html#le-test-de-fisher-snedecor"><i class="fa fa-check"></i><b>4.2</b> Le test de Fisher-Snedecor</a><ul>
<li class="chapter" data-level="4.2.1" data-path="Test.html"><a href="Test.html#principe"><i class="fa fa-check"></i><b>4.2.1</b> Principe</a></li>
<li class="chapter" data-level="4.2.2" data-path="Test.html"><a href="Test.html#comblinconjointes"><i class="fa fa-check"></i><b>4.2.2</b> La statistique de test</a></li>
<li class="chapter" data-level="4.2.3" data-path="Test.html"><a href="Test.html#règle-de-décision"><i class="fa fa-check"></i><b>4.2.3</b> Règle de décision</a></li>
<li class="chapter" data-level="4.2.4" data-path="Test.html"><a href="Test.html#comblin"><i class="fa fa-check"></i><b>4.2.4</b> Cas particulier où <span class="math inline">\(q=1\)</span> : Test de Student</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="Test.html"><a href="Test.html#intervalle-région-de-confiance-pour-ctheta"><i class="fa fa-check"></i><b>4.3</b> Intervalle (région) de confiance pour <span class="math inline">\(C\theta\)</span></a><ul>
<li class="chapter" data-level="4.3.1" data-path="Test.html"><a href="Test.html#ic-pour-ctheta-in-mathbbr"><i class="fa fa-check"></i><b>4.3.1</b> IC pour <span class="math inline">\(C\theta \in \mathbb{R}\)</span></a></li>
<li class="chapter" data-level="4.3.2" data-path="Test.html"><a href="Test.html#région-de-confiance-pour-ctheta-in-mathbbrq"><i class="fa fa-check"></i><b>4.3.2</b> Région de confiance pour <span class="math inline">\(C\theta \in \mathbb{R}^q\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="Test.html"><a href="Test.html#en-résumé-2"><i class="fa fa-check"></i><b>4.4</b> En résumé</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="singulier.html"><a href="singulier.html"><i class="fa fa-check"></i><b>5</b> Modèles singuliers, orthogonalité et importance des hypothèses sur les erreurs</a><ul>
<li class="chapter" data-level="5.1" data-path="singulier.html"><a href="singulier.html#quand-h1-h4-ne-sont-pas-respectées"><i class="fa fa-check"></i><b>5.1</b> Quand H1-H4 ne sont pas respectées…</a><ul>
<li class="chapter" data-level="5.1.1" data-path="singulier.html"><a href="singulier.html#propriétés-de-lestimateur-des-moindres-carrés-widehattheta"><i class="fa fa-check"></i><b>5.1.1</b> Propriétés de l’estimateur des moindres carrés <span class="math inline">\(\widehat{\theta}\)</span></a></li>
<li class="chapter" data-level="5.1.2" data-path="singulier.html"><a href="singulier.html#propriétés-de-lestimateur-des-moindres-carrés-widehatsigma2"><i class="fa fa-check"></i><b>5.1.2</b> Propriétés de l’estimateur des moindres carrés <span class="math inline">\(\widehat{\sigma}^2\)</span></a></li>
<li class="chapter" data-level="5.1.3" data-path="singulier.html"><a href="singulier.html#modèles-avec-corrélations"><i class="fa fa-check"></i><b>5.1.3</b> Modèles avec corrélations</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="singulier.html"><a href="singulier.html#ModSingulier"><i class="fa fa-check"></i><b>5.2</b> Modèles singuliers</a><ul>
<li class="chapter" data-level="5.2.1" data-path="singulier.html"><a href="singulier.html#contraintes-didentifiabilité"><i class="fa fa-check"></i><b>5.2.1</b> Contraintes d’identifiabilité</a></li>
<li class="chapter" data-level="5.2.2" data-path="singulier.html"><a href="singulier.html#fonctions-estimables-et-contrastes"><i class="fa fa-check"></i><b>5.2.2</b> Fonctions estimables et contrastes</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="singulier.html"><a href="singulier.html#orthogonalité"><i class="fa fa-check"></i><b>5.3</b> Orthogonalité</a><ul>
<li class="chapter" data-level="5.3.1" data-path="singulier.html"><a href="singulier.html#orthogonalité-pour-les-modèles-réguliers"><i class="fa fa-check"></i><b>5.3.1</b> Orthogonalité pour les modèles réguliers</a></li>
<li class="chapter" data-level="5.3.2" data-path="singulier.html"><a href="singulier.html#orthogonalité-pour-les-modèles-non-réguliers"><i class="fa fa-check"></i><b>5.3.2</b> Orthogonalité pour les modèles non-réguliers</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="singulier.html"><a href="singulier.html#en-résumé-3"><i class="fa fa-check"></i><b>5.4</b> En résumé</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>6</b> La régression linéaire</a><ul>
<li class="chapter" data-level="6.1" data-path="regression.html"><a href="regression.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="6.1.1" data-path="regression.html"><a href="regression.html#exemple-illustratif"><i class="fa fa-check"></i><b>6.1.1</b> Exemple illustratif</a></li>
<li class="chapter" data-level="6.1.2" data-path="regression.html"><a href="regression.html#problématique"><i class="fa fa-check"></i><b>6.1.2</b> Problématique</a></li>
<li class="chapter" data-level="6.1.3" data-path="regression.html"><a href="regression.html#le-modèle-de-régression-linéaire-simple"><i class="fa fa-check"></i><b>6.1.3</b> Le modèle de régression linéaire simple</a></li>
<li class="chapter" data-level="6.1.4" data-path="regression.html"><a href="regression.html#le-modèle-de-régression-linéaire-multiple"><i class="fa fa-check"></i><b>6.1.4</b> Le modèle de régression linéaire multiple</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="regression.html"><a href="regression.html#estimation"><i class="fa fa-check"></i><b>6.2</b> Estimation</a><ul>
<li class="chapter" data-level="6.2.1" data-path="regression.html"><a href="regression.html#résultats-généraux"><i class="fa fa-check"></i><b>6.2.1</b> Résultats généraux</a></li>
<li class="chapter" data-level="6.2.2" data-path="regression.html"><a href="regression.html#propriétés-en-régression-linéaire-simple"><i class="fa fa-check"></i><b>6.2.2</b> Propriétés en régression linéaire simple</a></li>
<li class="chapter" data-level="6.2.3" data-path="regression.html"><a href="regression.html#le-coefficient-r2"><i class="fa fa-check"></i><b>6.2.3</b> Le coefficient <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regression.html"><a href="regression.html#tests-et-intervalles-de-confiance"><i class="fa fa-check"></i><b>6.3</b> Tests et intervalles de confiance</a><ul>
<li class="chapter" data-level="6.3.1" data-path="regression.html"><a href="regression.html#test-de-nullité-dun-paramètre-du-modèle"><i class="fa fa-check"></i><b>6.3.1</b> Test de nullité d’un paramètre du modèle</a></li>
<li class="chapter" data-level="6.3.2" data-path="regression.html"><a href="regression.html#test-de-nullité-de-quelques-paramètres-du-modèle"><i class="fa fa-check"></i><b>6.3.2</b> Test de nullité de quelques paramètres du modèle</a></li>
<li class="chapter" data-level="6.3.3" data-path="regression.html"><a href="regression.html#test-de-nullité-de-tous-les-paramètres-du-modèle"><i class="fa fa-check"></i><b>6.3.3</b> Test de nullité de tous les paramètres du modèle</a></li>
<li class="chapter" data-level="6.3.4" data-path="regression.html"><a href="regression.html#intervalle-de-confiance-de-theta_j-de-xtheta_i-et-de-x_0theta-1"><i class="fa fa-check"></i><b>6.3.4</b> Intervalle de confiance de <span class="math inline">\(\theta_j\)</span>, de <span class="math inline">\((X\theta)_i\)</span> et de <span class="math inline">\(X_0\theta\)</span></a></li>
<li class="chapter" data-level="6.3.5" data-path="regression.html"><a href="regression.html#intervalle-de-prédiction"><i class="fa fa-check"></i><b>6.3.5</b> Intervalle de prédiction</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="regression.html"><a href="regression.html#sélection-des-variables-explicatives"><i class="fa fa-check"></i><b>6.4</b> Sélection des variables explicatives</a><ul>
<li class="chapter" data-level="6.4.1" data-path="regression.html"><a href="regression.html#cadre-général-de-sélection-de-modèles"><i class="fa fa-check"></i><b>6.4.1</b> Cadre général de sélection de modèles</a></li>
<li class="chapter" data-level="6.4.2" data-path="regression.html"><a href="regression.html#quelques-critères-pour-sélectionner-un-modèle"><i class="fa fa-check"></i><b>6.4.2</b> Quelques critères pour sélectionner un modèle</a></li>
<li class="chapter" data-level="6.4.3" data-path="regression.html"><a href="regression.html#algorithmes-de-sélection-de-variables"><i class="fa fa-check"></i><b>6.4.3</b> Algorithmes de sélection de variables</a></li>
<li class="chapter" data-level="6.4.4" data-path="regression.html"><a href="regression.html#illustration-sur-lexemple"><i class="fa fa-check"></i><b>6.4.4</b> Illustration sur l’exemple</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="regression.html"><a href="regression.html#régression-linéaire-régularisée"><i class="fa fa-check"></i><b>6.5</b> Régression linéaire régularisée</a><ul>
<li class="chapter" data-level="6.5.1" data-path="regression.html"><a href="regression.html#régression-ridge"><i class="fa fa-check"></i><b>6.5.1</b> Régression ridge</a></li>
<li class="chapter" data-level="6.5.2" data-path="regression.html"><a href="regression.html#régression-lasso"><i class="fa fa-check"></i><b>6.5.2</b> Régression Lasso</a></li>
<li class="chapter" data-level="6.5.3" data-path="regression.html"><a href="regression.html#régression-elastic-net"><i class="fa fa-check"></i><b>6.5.3</b> Régression Elastic-Net</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="regression.html"><a href="regression.html#ValidationMod"><i class="fa fa-check"></i><b>6.6</b> Validation du modèle</a><ul>
<li class="chapter" data-level="6.6.1" data-path="regression.html"><a href="regression.html#contrôle-graphique-a-posteriori"><i class="fa fa-check"></i><b>6.6.1</b> Contrôle graphique a posteriori</a></li>
<li class="chapter" data-level="6.6.2" data-path="regression.html"><a href="regression.html#pour-vérifier-les-hypothèses-h1-et-h2-adéquation-et-homoscédasticité"><i class="fa fa-check"></i><b>6.6.2</b> Pour vérifier les hypothèses H1 et H2 : adéquation et homoscédasticité</a></li>
<li class="chapter" data-level="6.6.3" data-path="regression.html"><a href="regression.html#pour-vérifier-lhypothèse-h3-indépendance"><i class="fa fa-check"></i><b>6.6.3</b> Pour vérifier l’hypothèse H3 : indépendance</a></li>
<li class="chapter" data-level="6.6.4" data-path="regression.html"><a href="regression.html#pour-vérifier-lhypothèse-h4-gaussianité"><i class="fa fa-check"></i><b>6.6.4</b> Pour vérifier l’hypothèse H4 : gaussianité</a></li>
<li class="chapter" data-level="6.6.5" data-path="regression.html"><a href="regression.html#détection-de-données-aberrantes"><i class="fa fa-check"></i><b>6.6.5</b> Détection de données aberrantes</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="regression.html"><a href="regression.html#en-résumé-4"><i class="fa fa-check"></i><b>6.7</b> En résumé</a></li>
<li class="chapter" data-level="6.8" data-path="regression.html"><a href="regression.html#quelques-codes-python"><i class="fa fa-check"></i><b>6.8</b> Quelques codes python</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ANOVA.html"><a href="ANOVA.html"><i class="fa fa-check"></i><b>7</b> Analyse de variance (ANOVA)</a><ul>
<li class="chapter" data-level="7.1" data-path="ANOVA.html"><a href="ANOVA.html#vocabulaire"><i class="fa fa-check"></i><b>7.1</b> Vocabulaire</a></li>
<li class="chapter" data-level="7.2" data-path="ANOVA.html"><a href="ANOVA.html#analyse-de-variance-à-un-facteur"><i class="fa fa-check"></i><b>7.2</b> Analyse de variance à un facteur</a><ul>
<li class="chapter" data-level="7.2.1" data-path="ANOVA.html"><a href="ANOVA.html#exemple-et-notations"><i class="fa fa-check"></i><b>7.2.1</b> Exemple et notations</a></li>
<li class="chapter" data-level="7.2.2" data-path="ANOVA.html"><a href="ANOVA.html#modèle-régulier"><i class="fa fa-check"></i><b>7.2.2</b> Modèle régulier</a></li>
<li class="chapter" data-level="7.2.3" data-path="ANOVA.html"><a href="ANOVA.html#modèle-singulier"><i class="fa fa-check"></i><b>7.2.3</b> Modèle singulier</a></li>
<li class="chapter" data-level="7.2.4" data-path="ANOVA.html"><a href="ANOVA.html#prédictions-résidus-et-variance"><i class="fa fa-check"></i><b>7.2.4</b> Prédictions, résidus et variance</a></li>
<li class="chapter" data-level="7.2.5" data-path="ANOVA.html"><a href="ANOVA.html#intervalle-de-confiance-et-test-sur-leffet-facteur"><i class="fa fa-check"></i><b>7.2.5</b> Intervalle de confiance et test sur l’effet facteur</a></li>
<li class="chapter" data-level="7.2.6" data-path="ANOVA.html"><a href="ANOVA.html#test-deffet-du-facteur"><i class="fa fa-check"></i><b>7.2.6</b> Test d’effet du facteur</a></li>
<li class="chapter" data-level="7.2.7" data-path="ANOVA.html"><a href="ANOVA.html#tableau-danalyse-de-la-variance-à-un-facteur"><i class="fa fa-check"></i><b>7.2.7</b> Tableau d’analyse de la variance à un facteur</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ANOVA.html"><a href="ANOVA.html#analyse-de-variance-à-deux-facteurs"><i class="fa fa-check"></i><b>7.3</b> Analyse de variance à deux facteurs</a><ul>
<li class="chapter" data-level="7.3.1" data-path="ANOVA.html"><a href="ANOVA.html#notations-et-exemple"><i class="fa fa-check"></i><b>7.3.1</b> Notations et exemple</a></li>
<li class="chapter" data-level="7.3.2" data-path="ANOVA.html"><a href="ANOVA.html#modélisation"><i class="fa fa-check"></i><b>7.3.2</b> Modélisation</a></li>
<li class="chapter" data-level="7.3.3" data-path="ANOVA.html"><a href="ANOVA.html#estimation-des-paramètres"><i class="fa fa-check"></i><b>7.3.3</b> Estimation des paramètres</a></li>
<li class="chapter" data-level="7.3.4" data-path="ANOVA.html"><a href="ANOVA.html#prédiction-résidus-et-variance"><i class="fa fa-check"></i><b>7.3.4</b> Prédiction, résidus et variance</a></li>
<li class="chapter" data-level="7.3.5" data-path="ANOVA.html"><a href="ANOVA.html#décomposition-de-la-variabilité"><i class="fa fa-check"></i><b>7.3.5</b> Décomposition de la variabilité</a></li>
<li class="chapter" data-level="7.3.6" data-path="ANOVA.html"><a href="ANOVA.html#le-diagramme-dinteractions"><i class="fa fa-check"></i><b>7.3.6</b> Le diagramme d’interactions</a></li>
<li class="chapter" data-level="7.3.7" data-path="ANOVA.html"><a href="ANOVA.html#tests-dhypothèses"><i class="fa fa-check"></i><b>7.3.7</b> Tests d’hypothèses</a></li>
<li class="chapter" data-level="7.3.8" data-path="ANOVA.html"><a href="ANOVA.html#test-dabsence-deffet-du-facteur-b"><i class="fa fa-check"></i><b>7.3.8</b> Test d’absence d’effet du facteur <span class="math inline">\(B\)</span></a></li>
<li class="chapter" data-level="7.3.9" data-path="ANOVA.html"><a href="ANOVA.html#tableau-danalyse-de-variance-à-deux-facteurs-croisés-dans-le-cas-dun-plan-orthogonal"><i class="fa fa-check"></i><b>7.3.9</b> Tableau d’analyse de variance à deux facteurs croisés dans le cas d’un plan orthogonal</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ANOVA.html"><a href="ANOVA.html#en-résumé-5"><i class="fa fa-check"></i><b>7.4</b> En résumé</a></li>
<li class="chapter" data-level="7.5" data-path="ANOVA.html"><a href="ANOVA.html#quelques-codes-en-python"><i class="fa fa-check"></i><b>7.5</b> Quelques codes en python</a><ul>
<li class="chapter" data-level="7.5.1" data-path="ANOVA.html"><a href="ANOVA.html#exemple-danova-à-un-facteur"><i class="fa fa-check"></i><b>7.5.1</b> Exemple d’ANOVA à un facteur</a></li>
<li class="chapter" data-level="7.5.2" data-path="ANOVA.html"><a href="ANOVA.html#exemple-danova-à-deux-facteurs"><i class="fa fa-check"></i><b>7.5.2</b> Exemple d’ANOVA à deux facteurs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ANCOVA.html"><a href="ANCOVA.html"><i class="fa fa-check"></i><b>8</b> Analyse de covariance (ANCOVA)</a><ul>
<li class="chapter" data-level="8.1" data-path="ANCOVA.html"><a href="ANCOVA.html#les-données"><i class="fa fa-check"></i><b>8.1</b> Les données</a></li>
<li class="chapter" data-level="8.2" data-path="ANCOVA.html"><a href="ANCOVA.html#modélisation-1"><i class="fa fa-check"></i><b>8.2</b> Modélisation</a><ul>
<li class="chapter" data-level="8.2.1" data-path="ANCOVA.html"><a href="ANCOVA.html#modélisation-régulière"><i class="fa fa-check"></i><b>8.2.1</b> Modélisation régulière</a></li>
<li class="chapter" data-level="8.2.2" data-path="ANCOVA.html"><a href="ANCOVA.html#modélisation-singulière"><i class="fa fa-check"></i><b>8.2.2</b> Modélisation singulière</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ANCOVA.html"><a href="ANCOVA.html#estimation-des-paramètres-1"><i class="fa fa-check"></i><b>8.3</b> Estimation des paramètres</a></li>
<li class="chapter" data-level="8.4" data-path="ANCOVA.html"><a href="ANCOVA.html#tests-dhypothèses-1"><i class="fa fa-check"></i><b>8.4</b> Tests d’hypothèses</a><ul>
<li class="chapter" data-level="8.4.1" data-path="ANCOVA.html"><a href="ANCOVA.html#absence-de-tout-effet"><i class="fa fa-check"></i><b>8.4.1</b> Absence de tout effet</a></li>
<li class="chapter" data-level="8.4.2" data-path="ANCOVA.html"><a href="ANCOVA.html#test-dabsence-dinteraction"><i class="fa fa-check"></i><b>8.4.2</b> Test d’absence d’interaction</a></li>
<li class="chapter" data-level="8.4.3" data-path="ANCOVA.html"><a href="ANCOVA.html#test-dabsence-de-leffet-de-la-covariable-z"><i class="fa fa-check"></i><b>8.4.3</b> Test d’absence de l’effet de la covariable z</a></li>
<li class="chapter" data-level="8.4.4" data-path="ANCOVA.html"><a href="ANCOVA.html#test-dabsence-de-leffet-facteur-t"><i class="fa fa-check"></i><b>8.4.4</b> Test d’absence de l’effet facteur T</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ANCOVA.html"><a href="ANCOVA.html#en-résumé-6"><i class="fa fa-check"></i><b>8.5</b> En résumé</a></li>
<li class="chapter" data-level="8.6" data-path="ANCOVA.html"><a href="ANCOVA.html#quelques-codes-en-python-1"><i class="fa fa-check"></i><b>8.6</b> Quelques codes en python</a></li>
</ul></li>
<li class="part"><span><b>II Le modèle linéaire généralisé</b></span></li>
<li class="chapter" data-level="9" data-path="GLM.html"><a href="GLM.html"><i class="fa fa-check"></i><b>9</b> Principe du modèle linéaire généralisé</a><ul>
<li class="chapter" data-level="9.1" data-path="GLM.html"><a href="GLM.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="GLM.html"><a href="GLM.html#caractérisation-dun-modèle-linéaire-généralisé"><i class="fa fa-check"></i><b>9.2</b> Caractérisation d’un modèle linéaire généralisé</a><ul>
<li class="chapter" data-level="9.2.1" data-path="GLM.html"><a href="GLM.html#loi-de-la-variable-réponse-y"><i class="fa fa-check"></i><b>9.2.1</b> Loi de la variable réponse <span class="math inline">\(Y\)</span></a></li>
<li class="chapter" data-level="9.2.2" data-path="GLM.html"><a href="GLM.html#prédicteur-linéaire"><i class="fa fa-check"></i><b>9.2.2</b> Prédicteur linéaire</a></li>
<li class="chapter" data-level="9.2.3" data-path="GLM.html"><a href="GLM.html#fonction-de-lien"><i class="fa fa-check"></i><b>9.2.3</b> Fonction de lien</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="GLM.html"><a href="GLM.html#EstimMLG"><i class="fa fa-check"></i><b>9.3</b> Estimation</a><ul>
<li class="chapter" data-level="9.3.1" data-path="GLM.html"><a href="GLM.html#estimation-par-maximum-de-vraisemblance"><i class="fa fa-check"></i><b>9.3.1</b> Estimation par maximum de vraisemblance</a></li>
<li class="chapter" data-level="9.3.2" data-path="GLM.html"><a href="GLM.html#algorithmes-de-newton-raphson-et-fisher-scoring"><i class="fa fa-check"></i><b>9.3.2</b> Algorithmes de Newton-Raphson et Fisher-scoring</a></li>
<li class="chapter" data-level="9.3.3" data-path="GLM.html"><a href="GLM.html#equations-de-vraisemblance"><i class="fa fa-check"></i><b>9.3.3</b> Equations de vraisemblance</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="GLM.html"><a href="GLM.html#NormalitéAsymptotique"><i class="fa fa-check"></i><b>9.4</b> Loi asymptotique de l’EMV et inférence</a></li>
<li class="chapter" data-level="9.5" data-path="GLM.html"><a href="GLM.html#tests-dhypothèses-2"><i class="fa fa-check"></i><b>9.5</b> Tests d’hypothèses</a><ul>
<li class="chapter" data-level="9.5.1" data-path="GLM.html"><a href="GLM.html#test-de-modèles-emboîtés"><i class="fa fa-check"></i><b>9.5.1</b> Test de modèles emboîtés</a></li>
<li class="chapter" data-level="9.5.2" data-path="GLM.html"><a href="GLM.html#TestParamMLG"><i class="fa fa-check"></i><b>9.5.2</b> Test d’un paramètre <span class="math inline">\(\theta_j\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="GLM.html"><a href="GLM.html#MLGIC"><i class="fa fa-check"></i><b>9.6</b> Intervalle de confiance pour <span class="math inline">\(\theta_j\)</span></a><ul>
<li class="chapter" data-level="9.6.1" data-path="GLM.html"><a href="GLM.html#par-wald"><i class="fa fa-check"></i><b>9.6.1</b> Par Wald</a></li>
<li class="chapter" data-level="9.6.2" data-path="GLM.html"><a href="GLM.html#fondé-sur-le-rapport-de-vraisemblances"><i class="fa fa-check"></i><b>9.6.2</b> Fondé sur le rapport de vraisemblances</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="GLM.html"><a href="GLM.html#qualité-dajustement-1"><i class="fa fa-check"></i><b>9.7</b> Qualité d’ajustement</a><ul>
<li class="chapter" data-level="9.7.1" data-path="GLM.html"><a href="GLM.html#le-pseudo-r2"><i class="fa fa-check"></i><b>9.7.1</b> Le pseudo <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="9.7.2" data-path="GLM.html"><a href="GLM.html#le-chi2-de-pearson-généralisé"><i class="fa fa-check"></i><b>9.7.2</b> Le <span class="math inline">\(\chi^2\)</span> de Pearson généralisé</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="GLM.html"><a href="GLM.html#ResidusGLM"><i class="fa fa-check"></i><b>9.8</b> Diagnostic, résidus</a></li>
<li class="chapter" data-level="9.9" data-path="GLM.html"><a href="GLM.html#en-résumé-7"><i class="fa fa-check"></i><b>9.9</b> En résumé</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="RegLogistique.html"><a href="RegLogistique.html"><i class="fa fa-check"></i><b>10</b> Régression logistique</a><ul>
<li class="chapter" data-level="10.1" data-path="RegLogistique.html"><a href="RegLogistique.html#introduction-2"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="RegLogistique.html"><a href="RegLogistique.html#pourquoi-des-modèles-particuliers"><i class="fa fa-check"></i><b>10.2</b> Pourquoi des modèles particuliers ?</a></li>
<li class="chapter" data-level="10.3" data-path="RegLogistique.html"><a href="RegLogistique.html#odds-et-odds-ratio"><i class="fa fa-check"></i><b>10.3</b> Odds et odds ratio</a></li>
<li class="chapter" data-level="10.4" data-path="RegLogistique.html"><a href="RegLogistique.html#régression-logistique-simple"><i class="fa fa-check"></i><b>10.4</b> Régression logistique simple</a><ul>
<li class="chapter" data-level="10.4.1" data-path="RegLogistique.html"><a href="RegLogistique.html#subquanti"><i class="fa fa-check"></i><b>10.4.1</b> Avec une variable explicative quantitative</a></li>
<li class="chapter" data-level="10.4.2" data-path="RegLogistique.html"><a href="RegLogistique.html#sect1expquali"><i class="fa fa-check"></i><b>10.4.2</b> Avec une variable explicative qualitative</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="RegLogistique.html"><a href="RegLogistique.html#régression-logistique-multiple"><i class="fa fa-check"></i><b>10.5</b> Régression logistique multiple</a><ul>
<li class="chapter" data-level="10.5.1" data-path="RegLogistique.html"><a href="RegLogistique.html#modèle-sans-interaction"><i class="fa fa-check"></i><b>10.5.1</b> Modèle sans interaction</a></li>
<li class="chapter" data-level="10.5.2" data-path="RegLogistique.html"><a href="RegLogistique.html#modèle-avec-interactions"><i class="fa fa-check"></i><b>10.5.2</b> Modèle avec interactions</a></li>
<li class="chapter" data-level="10.5.3" data-path="RegLogistique.html"><a href="RegLogistique.html#etude-complémentaire-du-modèle-retenu"><i class="fa fa-check"></i><b>10.5.3</b> Etude complémentaire du modèle retenu</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="RegLogistique.html"><a href="RegLogistique.html#quelques-codes-avec-python"><i class="fa fa-check"></i><b>10.6</b> Quelques codes avec python</a></li>
<li class="chapter" data-level="10.7" data-path="RegLogistique.html"><a href="RegLogistique.html#régression-polytomique"><i class="fa fa-check"></i><b>10.7</b> Régression polytomique</a><ul>
<li class="chapter" data-level="10.7.1" data-path="RegLogistique.html"><a href="RegLogistique.html#régression-multinomiale-ou-polytomique-non-ordonnée"><i class="fa fa-check"></i><b>10.7.1</b> Régression multinomiale ou polytomique non-ordonnée</a></li>
<li class="chapter" data-level="10.7.2" data-path="RegLogistique.html"><a href="RegLogistique.html#régression-polytomique-ordonnée"><i class="fa fa-check"></i><b>10.7.2</b> Régression polytomique ordonnée</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="RegLogLin.html"><a href="RegLogLin.html"><i class="fa fa-check"></i><b>11</b> Régression de Poisson / régression loglinéaire</a><ul>
<li class="chapter" data-level="11.1" data-path="RegLogLin.html"><a href="RegLogLin.html#modèle-de-régression-loglinéaire"><i class="fa fa-check"></i><b>11.1</b> Modèle de régression loglinéaire</a><ul>
<li class="chapter" data-level="11.1.1" data-path="RegLogLin.html"><a href="RegLogLin.html#pourquoi-un-modèle-particulier"><i class="fa fa-check"></i><b>11.1.1</b> Pourquoi un modèle particulier ?</a></li>
<li class="chapter" data-level="11.1.2" data-path="RegLogLin.html"><a href="RegLogLin.html#estimation-des-paramètres-3"><i class="fa fa-check"></i><b>11.1.2</b> Estimation des paramètres</a></li>
<li class="chapter" data-level="11.1.3" data-path="RegLogLin.html"><a href="RegLogLin.html#ajustement-et-prédiction"><i class="fa fa-check"></i><b>11.1.3</b> Ajustement et prédiction</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="RegLogLin.html"><a href="RegLogLin.html#exemple-de-régression-loglinéaire-avec-r"><i class="fa fa-check"></i><b>11.2</b> Exemple de régression loglinéaire avec R</a><ul>
<li class="chapter" data-level="11.2.1" data-path="RegLogLin.html"><a href="RegLogLin.html#régression-loglinéaire-simple"><i class="fa fa-check"></i><b>11.2.1</b> Régression loglinéaire simple</a></li>
<li class="chapter" data-level="11.2.2" data-path="RegLogLin.html"><a href="RegLogLin.html#régression-loglinéaire-multiple"><i class="fa fa-check"></i><b>11.2.2</b> Régression loglinéaire multiple</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="RegLogLin.html"><a href="RegLogLin.html#sur-dispersion-et-modèle-binomial-négatif"><i class="fa fa-check"></i><b>11.3</b> Sur-dispersion et modèle binomial négatif</a></li>
<li class="chapter" data-level="11.4" data-path="RegLogLin.html"><a href="RegLogLin.html#quelques-codes-avec-python-1"><i class="fa fa-check"></i><b>11.4</b> Quelques codes avec python</a></li>
</ul></li>
<li class="appendix"><span><b>Annexes</b></span></li>
<li class="chapter" data-level="A" data-path="rappels-de-probabilités-statistiques-et-doptimisation.html"><a href="rappels-de-probabilités-statistiques-et-doptimisation.html"><i class="fa fa-check"></i><b>A</b> Rappels de probabilités, statistiques et d’optimisation</a><ul>
<li class="chapter" data-level="A.1" data-path="rappels-de-probabilités-statistiques-et-doptimisation.html"><a href="rappels-de-probabilités-statistiques-et-doptimisation.html#rappels-sur-les-échantillons-gaussiens"><i class="fa fa-check"></i><b>A.1</b> Rappels sur les échantillons gaussiens</a><ul>
<li class="chapter" data-level="A.1.1" data-path="rappels-de-probabilités-statistiques-et-doptimisation.html"><a href="rappels-de-probabilités-statistiques-et-doptimisation.html#la-loi-normale"><i class="fa fa-check"></i><b>A.1.1</b> La loi normale</a></li>
<li class="chapter" data-level="A.1.2" data-path="rappels-de-probabilités-statistiques-et-doptimisation.html"><a href="rappels-de-probabilités-statistiques-et-doptimisation.html#vecteurs-gaussiens"><i class="fa fa-check"></i><b>A.1.2</b> Vecteurs gaussiens</a></li>
<li class="chapter" data-level="A.1.3" data-path="rappels-de-probabilités-statistiques-et-doptimisation.html"><a href="rappels-de-probabilités-statistiques-et-doptimisation.html#loi-du-khi-deux-loi-de-student-loi-de-fisher"><i class="fa fa-check"></i><b>A.1.3</b> Loi du khi-deux, loi de Student, loi de Fisher</a></li>
<li class="chapter" data-level="A.1.4" data-path="rappels-de-probabilités-statistiques-et-doptimisation.html"><a href="rappels-de-probabilités-statistiques-et-doptimisation.html#estimation-de-la-moyenne-et-de-la-variance-dun-échantillon-gaussien"><i class="fa fa-check"></i><b>A.1.4</b> Estimation de la moyenne et de la variance d’un échantillon gaussien</a></li>
<li class="chapter" data-level="A.1.5" data-path="rappels-de-probabilités-statistiques-et-doptimisation.html"><a href="rappels-de-probabilités-statistiques-et-doptimisation.html#construction-dintervalles-de-confiance"><i class="fa fa-check"></i><b>A.1.5</b> Construction d’intervalles de confiance</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="rappels-de-probabilités-statistiques-et-doptimisation.html"><a href="rappels-de-probabilités-statistiques-et-doptimisation.html#estimation-sans-biais-de-variance-minimale"><i class="fa fa-check"></i><b>A.2</b> Estimation sans biais de variance minimale</a></li>
<li class="chapter" data-level="A.3" data-path="rappels-de-probabilités-statistiques-et-doptimisation.html"><a href="rappels-de-probabilités-statistiques-et-doptimisation.html#Newton-Raphson"><i class="fa fa-check"></i><b>A.3</b> La méthode de Newton-Raphson</a></li>
<li class="chapter" data-level="A.4" data-path="rappels-de-probabilités-statistiques-et-doptimisation.html"><a href="rappels-de-probabilités-statistiques-et-doptimisation.html#théorème-central-limite-condition-de-lindeberg"><i class="fa fa-check"></i><b>A.4</b> Théorème central limite: condition de Lindeberg</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="preuves-de-quelques-résultats-du-cours.html"><a href="preuves-de-quelques-résultats-du-cours.html"><i class="fa fa-check"></i><b>B</b> Preuves de quelques résultats du cours</a><ul>
<li class="chapter" data-level="B.1" data-path="preuves-de-quelques-résultats-du-cours.html"><a href="preuves-de-quelques-résultats-du-cours.html#ProofFisher"><i class="fa fa-check"></i><b>B.1</b> Preuve pour le test de Fisher</a></li>
<li class="chapter" data-level="B.2" data-path="preuves-de-quelques-résultats-du-cours.html"><a href="preuves-de-quelques-résultats-du-cours.html#annexe:ortho"><i class="fa fa-check"></i><b>B.2</b> Preuve de la proposition @ref(prp:Proportho)</a></li>
<li class="chapter" data-level="B.3" data-path="preuves-de-quelques-résultats-du-cours.html"><a href="preuves-de-quelques-résultats-du-cours.html#annexe:risque"><i class="fa fa-check"></i><b>B.3</b> Preuve de la proposition @ref(prp:risque)</a></li>
<li class="chapter" data-level="B.4" data-path="preuves-de-quelques-résultats-du-cours.html"><a href="preuves-de-quelques-résultats-du-cours.html#annexe:KL"><i class="fa fa-check"></i><b>B.4</b> Preuve de la proposition @ref(prp:KL)</a></li>
<li class="chapter" data-level="B.5" data-path="preuves-de-quelques-résultats-du-cours.html"><a href="preuves-de-quelques-résultats-du-cours.html#annexe:Mallows"><i class="fa fa-check"></i><b>B.5</b> Critère du <span class="math inline">\(C_p\)</span> de Mallows</a></li>
<li class="chapter" data-level="B.6" data-path="preuves-de-quelques-résultats-du-cours.html"><a href="preuves-de-quelques-résultats-du-cours.html#annexe:Sj"><i class="fa fa-check"></i><b>B.6</b> Preuve de la proposition @ref(prp:eqSj)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li>Cathy Maugis-Rabusseau</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modèle linéaire général et modèle linéaire généralisé</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ANCOVA" class="section level1">
<h1><span class="header-section-number">Chapitre 8</span> Analyse de covariance (ANCOVA)</h1>
<blockquote>
<p>Les slides associés à l’ANCOVA sont disponibles <a href="https://github.com/cmaugis/UF-EMS/blob/main/Slides-EMS-2122/Slides-ANCOVA.pdf">ici</a></p>
<p>Le jeu de données utilisé dans ce chapitre est disponible ici <a href="Data/ble.csv">Ble.txt</a></p>
</blockquote>
<div id="les-données" class="section level2">
<h2><span class="header-section-number">8.1</span> Les données</h2>
<p>Dans ce chapitre, nous allons présenter le modèle d’analyse de covariance (ANCOVA) seulement dans le cadre simple où on observe deux variables quantitatives <span class="math inline">\(z\)</span> et <span class="math inline">\(Y\)</span>, et une variable qualitative <span class="math inline">\(T\)</span> sur un échantillon de <span class="math inline">\(n\)</span> individus : la variable quantitative <span class="math inline">\(Y\)</span> est la variable réponse que l’on cherche à expliquer en fonction de la variable quantitative <span class="math inline">\(z\)</span> (appelée ) et du facteur <span class="math inline">\(T\)</span> à <span class="math inline">\(I\)</span> niveaux. Les notions peuvent être généralisées pour plusieurs covariables et plusieurs facteurs.</p>
<p>Chaque individu de l’échantillon est repéré par un double indice <span class="math inline">\((i,j)\)</span>, <span class="math inline">\(i\)</span> représente le niveau du facteur <span class="math inline">\(T\)</span> auquel appartient l’individu et <span class="math inline">\(j\)</span> correspond à l’indice de l’individu dans le niveau <span class="math inline">\(i\)</span>. Pour chaque individu <span class="math inline">\((i,j)\)</span>, on dispose d’une valeur <span class="math inline">\(z_{ij}\)</span> de la variable <span class="math inline">\(z\)</span> et d’une valeur <span class="math inline">\(Y_{ij}\)</span> de la variable <span class="math inline">\(Y\)</span>. Pour chaque niveau <span class="math inline">\(i\)</span> de <span class="math inline">\(T\)</span> (avec <span class="math inline">\(i=1,\cdots, I\)</span>), on observe <span class="math inline">\(n_i\)</span> valeurs <span class="math inline">\(z_{(i)} =(z_{i1}, \cdots, z_{in_i})&#39;\)</span> de <span class="math inline">\(z\)</span> et <span class="math inline">\(n_i\)</span> valeurs <span class="math inline">\(Y_{(i)} = (Y_{i1}, \cdots, Y_{in_i})&#39;\)</span> de <span class="math inline">\(Y\)</span>. Au final <span class="math inline">\(n=\sum_{i=1}^I n_i\)</span> est le nombre d’observations disponibles.</p>
<p>Dans tout ce chapitre, nous allons illustrer les notions abordées à l’aide de l’exemple suivant.</p>
<div class="example">
<p><span id="exm:unlabeled-div-53" class="example"><strong>Example 8.1  </strong></span>On cherche à savoir si des conditions de température et d’oxygénation influencent l’évolution du poids des huîtres.
On dispose de <span class="math inline">\(n = 20\)</span> sacs de <span class="math inline">\(10\)</span> huitres. On place, pendant
un mois, ces <span class="math inline">\(20\)</span> sacs de façon aléatoire dans <span class="math inline">\(I = 5\)</span> emplacements différents d’un canal de
refroidissement d’une centrale électrique à raison de <span class="math inline">\(n_i = 4\)</span> sacs par emplacement. Ces
emplacements se différencient par leurs températures et oxygénations. Pour chaque sac,
on a</p>
<ul>
<li>son poids avant l’expérience (variable Pds Init),</li>
<li>son poids après l’expérience (variable Pds Final),</li>
<li>l’emplacement (variable Traitement) codé de 1 à 5.</li>
</ul>
</div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="ANCOVA.html#cb106-1"></a><span class="kw">print</span>(oyster)</span></code></pre></div>
<pre><code>   InitWeight FinalWeight Treatment
1        27.2        32.6         1
2        32.0        36.6         1
3        33.0        37.7         1
4        26.8        31.0         1
5        28.6        33.8         2
6        26.8        31.7         2
7        26.5        30.7         2
8        26.8        30.4         2
9        28.6        35.2         3
10       22.4        29.1         3
11       23.2        28.9         3
12       24.4        30.2         3
13       29.3        35.0         4
14       21.8        27.0         4
15       30.3        36.4         4
16       24.3        30.5         4
17       20.4        24.6         5
18       19.6        23.4         5
19       25.1        30.3         5
20       18.1        21.8         5</code></pre>
<p>Les données peuvent être représentées conjointement sur un même graphique permettant de visualiser la relation éventuelle entre <span class="math inline">\(Y, \, z\)</span> et <span class="math inline">\(T\)</span>. Il s’agit de tracer un nuage de points de coordonnées <span class="math inline">\((z_{ij},Y_{ij})\)</span>, où tous les points du niveau <span class="math inline">\(i\)</span>, <span class="math inline">\(i=1, \cdots, I\)</span>, sont représentés par le même symbole (Figure <a href="ANCOVA.html#fig:FigxYgp">8.1</a>).
On peut également tracer un boxplot du poids initial et du poids final pour chaque emplacement (Figure <a href="ANCOVA.html#fig:Figboxplot">8.2</a>).</p>
<div class="figure"><span id="fig:FigxYgp"></span>
<img src="Bookdown-poly_files/figure-html/FigxYgp-1.png" alt="\label{FigxYgp}  Graphique des poids finaux par rapport aux poids initiaux selon chaque emplacement." width="672" />
<p class="caption">
Figure 8.1:  Graphique des poids finaux par rapport aux poids initiaux selon chaque emplacement.
</p>
</div>
<div class="figure"><span id="fig:Figboxplot"></span>
<img src="Bookdown-poly_files/figure-html/Figboxplot-1.png" alt="\label{Figboxplot} Evolution des poids initiaux et poids finaux pour chaque traitement" width="672" />
<p class="caption">
Figure 8.2:  Evolution des poids initiaux et poids finaux pour chaque traitement
</p>
</div>
</div>
<div id="modélisation-1" class="section level2">
<h2><span class="header-section-number">8.2</span> Modélisation</h2>
<div id="modélisation-régulière" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Modélisation régulière</h3>
<p>Dans le cadre d’une ANCOVA simple, le modèle régulier s’écrit sous la forme :
<span class="math display">\[(MR) : Y_{ij} =a_i + b_i\ z_{ij} +\varepsilon_{ij}, \forall i=1, \cdots, I, \, j=1, \cdots, n_i\]</span>
où <span class="math inline">\(\varepsilon_{ij}\sim\mathcal{N}(0,\sigma^2)\)</span>, <span class="math inline">\(n\)</span> variables indépendantes.
Cela revient à estimer une droite de régression linéaire de <span class="math inline">\(Y\)</span> sur <span class="math inline">\(z\)</span> pour chaque niveau <span class="math inline">\(i\)</span> du facteur <span class="math inline">\(T\)</span>. Pour le niveau <span class="math inline">\(i\)</span>, on estime les paramètres <span class="math inline">\(a_i\)</span>, constantes à l’origine des droites de régression et <span class="math inline">\(b_i\)</span>, pentes des droites de régression.</p>
<p>Matriciellement, le modèle s’écrit sous la forme
<span class="math display">\[
\underbrace{\left(\begin{array}{c}
Y_{(1)} \\ \vdots \\ \vdots \\ Y_{(I)}
\end{array}\right)}_{Y}
 = 
\underbrace{\left(\begin{array}{c c c c}
X_{(1)} &amp;         &amp;             &amp;  \\
        &amp; X_{(2)} &amp;             &amp; \\
        &amp;         &amp; \ddots &amp;  \\
        &amp;         &amp;            &amp; X_{(I)}
\end{array}\right)}_{X} 
 \underbrace{\left(\begin{array}{c}
a_1 \\ b_1 \\  \vdots \\ a_I \\ b_I
\end{array}\right)}_{\theta}
+
\underbrace{\left(\begin{array}{c}
\varepsilon_{(1)} \\ \vdots \\ \vdots \\ \varepsilon_{(I)}
\end{array}\right)}_{\varepsilon}
\textrm{  avec  }
X_{(i)} = \left(\begin{array}{cc}  1&amp; z_{i1}\\  \vdots&amp;\vdots\\ 1&amp; z_{i,n_i} \end{array}\right)
\]</span></p>
</div>
<div id="modélisation-singulière" class="section level3">
<h3><span class="header-section-number">8.2.2</span> Modélisation singulière</h3>
<p>Comme pour les modèles factoriels, il existe une reparamétrisation faisant apparaître des effets différentiels par rapport à un niveau de référence. Le modèle associé à cette nouvelle paramétrisation s’écrit :</p>
<p><span class="math display">\[
(MS) : Y_{ij}  = (\mu + \alpha_i) + (\beta + \gamma_i) z_{ij} + \varepsilon_{ij},\ \ \forall i=1, \cdots, I, \, j=1, \cdots, n_i.
\]</span></p>
<p>Cette paramétrisation permet de faire apparaître :</p>
<ul>
<li>un effet d’interaction entre la covariable <span class="math inline">\(z\)</span> et le facteur <span class="math inline">\(T\)</span> : <span class="math inline">\(\gamma_{i}\)</span> ;</li>
<li>un effet différentiel du facteur <span class="math inline">\(T\)</span> sur la variable <span class="math inline">\(Y\)</span> : <span class="math inline">\(\alpha_i\)</span> ;</li>
<li>un effet différentiel de la covariable <span class="math inline">\(z\)</span> sur la variable <span class="math inline">\(Y\)</span> : <span class="math inline">\(\beta\)</span>.</li>
</ul>
<div class="exercise">
<p><span id="exr:unlabeled-div-54" class="exercise"><strong>Exercise 8.1  </strong></span>Considérons le premier niveau comme référence dans cette paramétrisation (MS) pour rendre le modèle identifiable (ce qui est fait sous R par défaut). Les contraintes d’identifiabilité sont donc <span class="math inline">\(\alpha_1=\gamma_1=0\)</span>.
Dans ce cas, donnez le lien entre les paramètres <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma_i\)</span> et les paramètres <span class="math inline">\(a_i\)</span> et <span class="math inline">\(b_i\)</span> de la modélisation (MR). Donnez une interprétation “graphique” des paramètres <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta\)</span> et <span class="math inline">\(\gamma_i\)</span>.
<!--
%les paramètres représentent respectivement 
%$$
%\begin{array}{l l}
%\mu=a_1 & \textrm{ ordonnée à l'origine de la droite du niveau } 1\\
%\alpha_i = a_i - \mu & \textrm{ la différence d'ordonnée à l'origine des droites de régression}\\
%&\textrm{ entre les niveaux } i  \textrm{ et } 1\\
%\beta =b_1& \textrm{ pente de la droite pour le niveau } 1\\
%\gamma_i = b_i - \beta & \textrm{ la différence de pentes des droites de régression}\\ 
%& \textrm{ entre les niveaux }i \textrm{ et } 1 
%\end{array}
%$$
--></p>
</div>
</div>
</div>
<div id="estimation-des-paramètres-1" class="section level2">
<h2><span class="header-section-number">8.3</span> Estimation des paramètres</h2>
<p>Dans le cas du modèle régulier (MR), on peut utiliser la formule générale <span class="math inline">\(\hat \theta = (X&#39;X)^{-1}X&#39;Y\)</span>.
En utilisant le fait que la matrice <span class="math inline">\(X\)</span> est diagonale par bloc, <span class="math inline">\(X=\mbox{diag}(X_{(1)},\ldots,X_{(I)})\)</span>, on obtient que</p>
<p><span class="math display">\[
\hat\theta = \left(\begin{array}{c} (X_{(1)}&#39;X_{(1)})^{-1}X&#39;_{(1)} Y_{(1)}\\ \vdots\\ X_{(I)}&#39;X_{(I)})^{-1}X&#39;_{(I)} Y_{(I)}\end{array}\right).
\]</span>
On en déduit des résultats en régression linéaire simple que</p>
<p><span class="math display">\[
\left\{\begin{array}{l}
\displaystyle \widehat{b}_i = \frac{\mbox{cov}(Y_{(i)},z_{(i)}) }{\mbox{var}(z_{(i)})} \\
\\
\widehat{a}_i = \bar Y_{(i)} - \bar z_{(i)} \widehat{b}_i
\end{array}\right.
\]</span></p>
<p>Dans notre exemple, on obtient les estimations suivantes :</p>
<pre><code>     a1    b1     a2    b2    a3    b3    a4    b4     a5    b5
1 5.241 0.983 -9.149 1.501 4.818 1.056 4.296 1.057 -0.432 1.224</code></pre>
<p>et on peut graphiquement observer l’ajustement des droites de régression aux données (Figure <a href="ANCOVA.html#fig:plotMR">8.3</a>).</p>
<div class="figure"><span id="fig:plotMR"></span>
<img src="Bookdown-poly_files/figure-html/plotMR-1.png" alt="\label{plotMR} Ajustement des droites de régression aux données" width="672" />
<p class="caption">
Figure 8.3:  Ajustement des droites de régression aux données
</p>
</div>
<p>Dans le cas du modèle singulier (MS) avec les contraintes d’identifiabilité <span class="math inline">\(\alpha_1=\gamma_1=0\)</span>, on peut déduire les estimateurs en faisant le lien entre de modèle singulier et le modèle régulier (MR). On obtient donc
<span class="math display">\[
\left\{
\begin{array}{l}
\hat\mu = \hat a_1\\
\hat \alpha_i = \hat a_i - \hat a_1\\
\hat \beta = \hat b_1\\
\hat \gamma_i = \hat b_i - \hat b_1
\end{array}
\right.
\]</span></p>
<p>Dans notre exemple, on obtient les résultats suivants sous R</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="ANCOVA.html#cb109-1"></a>complet&lt;-<span class="kw">lm</span>(FinalWeight<span class="op">~</span>InitWeight <span class="op">*</span><span class="st"> </span>Treatment,<span class="dt">data=</span>oyster)</span>
<span id="cb109-2"><a href="ANCOVA.html#cb109-2"></a><span class="kw">summary</span>(complet)</span></code></pre></div>
<pre><code>
Call:
lm(formula = FinalWeight ~ InitWeight * Treatment, data = oyster)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.68699 -0.28193  0.02184  0.10425  0.63075 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             5.24126    2.86473   1.830   0.0972 .  
InitWeight              0.98265    0.09588  10.249 1.27e-06 ***
Treatment2            -14.39058    9.15971  -1.571   0.1472    
Treatment3             -0.42330    3.97747  -0.106   0.9174    
Treatment4             -0.94550    3.50725  -0.270   0.7930    
Treatment5             -5.67309    3.57150  -1.588   0.1433    
InitWeight:Treatment2   0.51871    0.33406   1.553   0.1515    
InitWeight:Treatment3   0.07342    0.14699   0.499   0.6282    
InitWeight:Treatment4   0.07428    0.12229   0.607   0.5571    
InitWeight:Treatment5   0.24124    0.13980   1.726   0.1151    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.5324 on 10 degrees of freedom
Multiple R-squared:  0.9921,    Adjusted R-squared:  0.985 
F-statistic: 139.5 on 9 and 10 DF,  p-value: 2.572e-09</code></pre>
<p>On peut ensuite s’intéresser à construire des intervalles de confiance pour ces paramètres, faire des tests de nullité pour chacun des paramètres, …</p>
</div>
<div id="tests-dhypothèses-1" class="section level2">
<h2><span class="header-section-number">8.4</span> Tests d’hypothèses</h2>
<div id="absence-de-tout-effet" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Absence de tout effet</h3>
<p>On peut tout d’abord commencer par tester l’absence de tout effet, aussi bien de la covariable <span class="math inline">\(z\)</span> que du facteur <span class="math inline">\(T\)</span>. Pour cela, on veut comparer le modèle “blanc” contre le modèle complet (MS)</p>
<ul>
<li><p><span class="math inline">\([M0] : Y_{ij} = \mu + \varepsilon_{ij},\, \forall i=1, \cdots, I,\, \forall j=1, \cdots, n_i\)</span></p></li>
<li><p><span class="math inline">\([MS]: \ Y_{ij}=\mu + \alpha_i + \beta z_{ij} + \gamma_{i}z_{ij} +\varepsilon_{ij},\, \forall i=1, \cdots, I,\, \forall j=1, \cdots, n_i.\)</span></p></li>
</ul>
<p>Le modèle <span class="math inline">\((M0)\)</span> consiste à ajuster une droite horizontale aux données (Figure <a href="ANCOVA.html#fig:plotM0">8.4</a>). Dans ce cas, la statistique de test du test de Fisher est</p>
<p><span class="math display">\[
F=\frac{SSE / (2I -1)}{SSR/n-2I} \underset{\mathcal{H}_0}{\sim} \mathcal{F}(2I-1,n-2I)
\]</span></p>
<p>avec <span class="math inline">\(SSR=\|Y - \widehat{Y}\|^2\)</span> et <span class="math inline">\(SSE=\|\widehat{Y} - \bar{Y}\mathbb{1}_n\|^2\)</span>.</p>
<p>Dans notre exemple, on obtient</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="ANCOVA.html#cb111-1"></a>M0&lt;-<span class="kw">lm</span>(FinalWeight<span class="op">~</span><span class="dv">1</span>,<span class="dt">data=</span>oyster)</span>
<span id="cb111-2"><a href="ANCOVA.html#cb111-2"></a><span class="kw">anova</span>(M0,complet)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Model 1: FinalWeight ~ 1
Model 2: FinalWeight ~ InitWeight * Treatment
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     19 358.67                                  
2     10   2.83  9    355.84 139.51 2.572e-09 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="figure"><span id="fig:plotM0"></span>
<img src="Bookdown-poly_files/figure-html/plotM0-1.png" alt="\label{plotM0} Ajustement du modèle (M0) aux données." width="672" />
<p class="caption">
Figure 8.4:  Ajustement du modèle (M0) aux données.
</p>
</div>
<p>Si on rejette le modèle (M0), on peut poursuivre l’étude mais il est important de suivre une démarche logique dans la mise en place des tests d’hypothèses, comme dans le cadre de l’analyse de la variance.</p>
</div>
<div id="test-dabsence-dinteraction" class="section level3">
<h3><span class="header-section-number">8.4.2</span> Test d’absence d’interaction</h3>
<p>On commence par tester l’hypothèse de non-interaction entre le facteur <span class="math inline">\(T\)</span> et la covariable <span class="math inline">\(z\)</span>. On souhaite donc tester l’hypothèse nulle suivante :</p>
<p><span class="math display">\[
\mathcal{H}_0^{(MnonI)} : b_1= b_2 = \cdots = b_I \Longleftrightarrow \gamma_{1} = \gamma_{2} = \cdots = \gamma_{I} = 0.
\]</span></p>
<p>Ce test revient à comparer le modèle complet et le sous-modèle sans interaction :</p>
<ul>
<li><p><span class="math inline">\([MS]: \ Y_{ij}=\mu + \alpha_i + (\beta+ \gamma_{i}) z_{ij} +\varepsilon_{ij},\, \forall i=1, \cdots, I,\, \forall j=1, \cdots, n_i\)</span></p></li>
<li><p><span class="math inline">\([MnonI]:\ Y_{ij}=\mu + \alpha_i+ \beta z_{ij} +\varepsilon_{ij},\, \forall i=1, \cdots, I,\, \forall j=1, \cdots, n_i.\)</span></p></li>
</ul>
<p>Le modèle <span class="math inline">\([MnonI]\)</span> consiste graphiquement à ajuster des droites parallèles pour chaque traitement (Figure <a href="ANCOVA.html#fig:plotnonI">8.5</a>).</p>
<div class="figure"><span id="fig:plotnonI"></span>
<img src="Bookdown-poly_files/figure-html/plotnonI-1.png" alt="\label{plotnonI} Ajustement du modèle d'ANCOVA sans interaction (à gauche) et avec interaction (à droite)." width="672" />
<p class="caption">
Figure 8.5:  Ajustement du modèle d’ANCOVA sans interaction (à gauche) et avec interaction (à droite).
</p>
</div>
<p>La statistique de test de Fisher vaut dans ce cas</p>
<p><span class="math display">\[
F = \frac{SSR_{nonI}-SSR / (I-1)}{SSR/(n-2I)}\underset{\mathcal{H}_0}{\sim}\mathcal{F}(I-1,n-2I)
\]</span></p>
<p>Si on rejette l’hypothèse <span class="math inline">\(\mathcal{H}_0^{[MnonI]}\)</span>, on conclut à la présence d’interactions dans le modèle. Il est alors inutile de tester l’absence d’effet du facteur <span class="math inline">\(T\)</span> ou de la covariable <span class="math inline">\(z\)</span> sur <span class="math inline">\(Y\)</span>, car toute variable constituant une interaction doit apparaître dans le modèle. En revanche, si le test montre que l’hypothèse <span class="math inline">\(\mathcal{H}_0^{[MnonI]}\)</span> est vraisemblable (i.e. les <span class="math inline">\(I\)</span> droites de régression partagent la même pente de régression), on peut alors évaluer l’effet de la covariable <span class="math inline">\(z\)</span> sur <span class="math inline">\(Y\)</span> et celui du facteur <span class="math inline">\(T\)</span> sur <span class="math inline">\(Y\)</span>.</p>
<p>Dans notre exemple, on retient le modèle sans interaction. Nous allons donc poursuivre notre étude.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="ANCOVA.html#cb113-1"></a>nonI&lt;-<span class="kw">lm</span>(FinalWeight<span class="op">~</span>InitWeight<span class="op">+</span>Treatment)</span>
<span id="cb113-2"><a href="ANCOVA.html#cb113-2"></a><span class="kw">summary</span>(nonI)</span></code></pre></div>
<pre><code>
Call:
lm(formula = FinalWeight ~ InitWeight + Treatment)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.8438 -0.3154 -0.2171  0.4863  0.8871 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.25040    1.44308   1.559 0.141205    
InitWeight   1.08318    0.04762  22.746 1.87e-12 ***
Treatment2  -0.03581    0.40723  -0.088 0.931169    
Treatment3   1.89922    0.45802   4.147 0.000988 ***
Treatment4   1.35157    0.41937   3.223 0.006135 ** 
Treatment5   0.24446    0.57658   0.424 0.678022    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.5492 on 14 degrees of freedom
Multiple R-squared:  0.9882,    Adjusted R-squared:  0.984 
F-statistic:   235 on 5 and 14 DF,  p-value: 5.493e-13</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="ANCOVA.html#cb115-1"></a><span class="kw">anova</span>(nonI,complet)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Model 1: FinalWeight ~ InitWeight + Treatment
Model 2: FinalWeight ~ InitWeight * Treatment
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1     14 4.2223                           
2     10 2.8340  4    1.3883 1.2247 0.3602</code></pre>
</div>
<div id="test-dabsence-de-leffet-de-la-covariable-z" class="section level3">
<h3><span class="header-section-number">8.4.3</span> Test d’absence de l’effet de la covariable z</h3>
<p>On souhaite tester l’hypothèse d’absence d’effet de la covariable <span class="math inline">\(z\)</span> sur <span class="math inline">\(Y\)</span> :
<span class="math display">\[\mathcal{H}_0^{[MT]} : b_1= b_2= \cdots = b_I= 0.\]</span>
Seul le facteur <span class="math inline">\(T\)</span> explique <span class="math inline">\(Y\)</span>. On met donc en place un modèle d’analyse de la variance à un facteur (Figure <a href="ANCOVA.html#fig:graphenonz">8.6</a>).</p>
On est donc ramené à comparer le modèle d’ANCOVA sans interaction avec le modèle d’anova à un facteur
<span class="math display">\[[MT]: \ Y_{ij}=\mu + \alpha_i +\varepsilon_{ij},\, \forall i=1, \cdots, I,\, \forall j=1, \cdots, n_i.\]</span>
<div class="figure"><span id="fig:graphenonz"></span>
<img src="Bookdown-poly_files/figure-html/graphenonz-1.png" alt="\label{graphenonz} Ajustement du modèle d'analyse de la variance à un facteur (à gauche) et le modèle d'ANCOVA sans interaction (à droite)." width="672" />
<p class="caption">
Figure 8.6:  Ajustement du modèle d’analyse de la variance à un facteur (à gauche) et le modèle d’ANCOVA sans interaction (à droite).
</p>
</div>
<p>La statistique de test de Fisher s’exprime alors comme suit :
<span class="math display">\[
F=\frac{SSR_T - SSR_{nonI} / 1}{SSR_{nonI}/(n-(I+1))}\underset{\mathcal{H}_0}{\sim}\mathcal{F}(1,n-(I+1))
\]</span></p>
<p>Dans notre exemple, on rejette l’absence d’effet du poids initial au risque <span class="math inline">\(5\%\)</span>.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="ANCOVA.html#cb117-1"></a>MT&lt;-<span class="kw">lm</span>(FinalWeight<span class="op">~</span>Treatment)</span>
<span id="cb117-2"><a href="ANCOVA.html#cb117-2"></a><span class="kw">anova</span>(MT,nonI)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Model 1: FinalWeight ~ Treatment
Model 2: FinalWeight ~ InitWeight + Treatment
  Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
1     15 160.263                                  
2     14   4.222  1    156.04 517.38 1.867e-12 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="test-dabsence-de-leffet-facteur-t" class="section level3">
<h3><span class="header-section-number">8.4.4</span> Test d’absence de l’effet facteur T</h3>
<p>On veut tester l’hypothèse d’absence d’effet du facteur <span class="math inline">\(T\)</span> sur <span class="math inline">\(Y\)</span>
<span class="math display">\[\mathcal{H}_0^{[Mz]} : a_1=a_2=\ldots=a_I  \Longleftrightarrow \alpha_1= \alpha_2 = \ldots = \alpha_I = 0.\]</span><br />
Les <span class="math inline">\(I\)</span> droites de régression partagent la même constante à l’origine, seule la covariable <span class="math inline">\(z\)</span> explique <span class="math inline">\(Y\)</span>. On met alors en place un modèle de régression linéaire simple (Figure <a href="ANCOVA.html#fig:graphenonT">8.7</a>)</p>
<p>On est donc ramené à comparer le modèle d’ANCOVA sans interaction avec un modèle de régression linéaire simple</p>
<span class="math display">\[[Mz]:\  Y_{ij}=\mu + \beta\ z_{ij}  +\varepsilon_{ij},\, \forall i=1, \cdots, I,\, \forall j=1, \cdots, n_i\]</span>
<div class="figure"><span id="fig:graphenonT"></span>
<img src="Bookdown-poly_files/figure-html/graphenonT-1.png" alt="\label{graphenonT} Ajustement du modèle de régression linéaire simple (à gauche) et du modèle d'ANCOVA sans interaction (à droite)." width="672" />
<p class="caption">
Figure 8.7:  Ajustement du modèle de régression linéaire simple (à gauche) et du modèle d’ANCOVA sans interaction (à droite).
</p>
</div>
<p>Dans ce cas, la statitsique de test de Fisher est définie par</p>
<p><span class="math display">\[
F=\frac{SSR_z - SSR_{nonI} / (I-1)}{SSR_{nonI} / (n-(I+1))}\underset{\mathcal{H}_0}{\sim}\mathcal{F}(I-1,n-(I+1))
\]</span></p>
<p>Pour notre exemple, on rejette également l’absence d’effet du traitement.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="ANCOVA.html#cb119-1"></a>Mz&lt;-<span class="kw">lm</span>(FinalWeight<span class="op">~</span>InitWeight)</span>
<span id="cb119-2"><a href="ANCOVA.html#cb119-2"></a><span class="kw">anova</span>(Mz,nonI)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Model 1: FinalWeight ~ InitWeight
Model 2: FinalWeight ~ InitWeight + Treatment
  Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
1     18 16.3117                                  
2     14  4.2223  4    12.089 10.021 0.0004819 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div>
<div id="en-résumé-6" class="section level2">
<h2><span class="header-section-number">8.5</span> En résumé</h2>
<div class="summarybox">
<ul>
<li>Savoir écrire un modèle d’ANCOVA (individuellement et matriciellement), régulier et singulier</li>
<li>Savoir distinguer un modèle régulier d’un modèle singulier</li>
<li>Savoir estimer les paramètres du modèle d’ANCOVA dans le cas régulier et dans le cas singulier (en s’adaptant à la / les contrainte(s) choisie(s))</li>
<li>Savoir construire un intervalle de confiance pour un paramètre du modèle d’ANCOVA</li>
<li>Savoir construire un test pour tester l’effet du facteur, l’effet d’interaction, … et savoir organiser ces différents tests</li>
<li>Savoir associer une représentation graphique à un sous-modèle d’ANCOVA</li>
</ul>
</div>
</div>
<div id="quelques-codes-en-python-1" class="section level2">
<h2><span class="header-section-number">8.6</span> Quelques codes en python</h2>
<div class="sourceCode" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="ANCOVA.html#cb121-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb121-2"><a href="ANCOVA.html#cb121-2"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb121-3"><a href="ANCOVA.html#cb121-3"></a><span class="co"># Récupération des données</span></span>
<span id="cb121-4"><a href="ANCOVA.html#cb121-4"></a>oysterpy<span class="op">=</span>r.oyster<span class="op">;</span></span>
<span id="cb121-5"><a href="ANCOVA.html#cb121-5"></a><span class="co"># Ajustement du modèle d&#39;ANCOVA avec inetraction</span></span>
<span id="cb121-6"><a href="ANCOVA.html#cb121-6"></a>completpy <span class="op">=</span> ols(<span class="st">&#39;FinalWeight ~ InitWeight * Treatment&#39;</span>, data<span class="op">=</span>oysterpy).fit()<span class="op">;</span></span>
<span id="cb121-7"><a href="ANCOVA.html#cb121-7"></a>completpy.summary()</span></code></pre></div>
<pre><code>&lt;class &#39;statsmodels.iolib.summary.Summary&#39;&gt;
&quot;&quot;&quot;
                            OLS Regression Results                            
==============================================================================
Dep. Variable:            FinalWeight   R-squared:                       0.992
Model:                            OLS   Adj. R-squared:                  0.985
Method:                 Least Squares   F-statistic:                     139.5
Date:                Jeu, 28 oct 2021   Prob (F-statistic):           2.57e-09
Time:                        12:20:28   Log-Likelihood:                -8.8384
No. Observations:                  20   AIC:                             37.68
Df Residuals:                      10   BIC:                             47.63
Df Model:                           9                                         
Covariance Type:            nonrobust                                         
=============================================================================================
                                coef    std err          t      P&gt;|t|      [0.025      0.975]
---------------------------------------------------------------------------------------------
Intercept                     5.2413      2.865      1.830      0.097      -1.142      11.624
Treatment[T.2]              -14.3906      9.160     -1.571      0.147     -34.800       6.019
Treatment[T.3]               -0.4233      3.977     -0.106      0.917      -9.286       8.439
Treatment[T.4]               -0.9455      3.507     -0.270      0.793      -8.760       6.869
Treatment[T.5]               -5.6731      3.572     -1.588      0.143     -13.631       2.285
InitWeight                    0.9826      0.096     10.249      0.000       0.769       1.196
InitWeight:Treatment[T.2]     0.5187      0.334      1.553      0.152      -0.226       1.263
InitWeight:Treatment[T.3]     0.0734      0.147      0.499      0.628      -0.254       0.401
InitWeight:Treatment[T.4]     0.0743      0.122      0.607      0.557      -0.198       0.347
InitWeight:Treatment[T.5]     0.2412      0.140      1.726      0.115      -0.070       0.553
==============================================================================
Omnibus:                        0.296   Durbin-Watson:                   1.831
Prob(Omnibus):                  0.862   Jarque-Bera (JB):                0.466
Skew:                           0.158   Prob(JB):                        0.792
Kurtosis:                       2.321   Cond. No.                     2.22e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.22e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
&quot;&quot;&quot;</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="ANCOVA.html#cb123-1"></a><span class="co"># Test d&#39;absence de tout effet</span></span>
<span id="cb123-2"><a href="ANCOVA.html#cb123-2"></a><span class="im">from</span> statsmodels.stats.anova <span class="im">import</span> anova_lm</span>
<span id="cb123-3"><a href="ANCOVA.html#cb123-3"></a>M0py <span class="op">=</span> ols(<span class="st">&#39;FinalWeight~1&#39;</span>, data<span class="op">=</span>oysterpy).fit()</span>
<span id="cb123-4"><a href="ANCOVA.html#cb123-4"></a>anova_lm(M0py,completpy)</span></code></pre></div>
<pre><code>   df_resid         ssr  df_diff     ss_diff           F        Pr(&gt;F)
0      19.0  358.669500      0.0         NaN         NaN           NaN
1      10.0    2.834009      9.0  355.835491  139.510053  2.572066e-09</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="ANCOVA.html#cb125-1"></a><span class="co"># Test d&#39;absence d&#39;interaction</span></span>
<span id="cb125-2"><a href="ANCOVA.html#cb125-2"></a>nonIpy <span class="op">=</span> ols(<span class="st">&#39;FinalWeight ~ InitWeight + Treatment&#39;</span>, data<span class="op">=</span>oysterpy).fit()</span>
<span id="cb125-3"><a href="ANCOVA.html#cb125-3"></a><span class="im">from</span> statsmodels.stats.anova <span class="im">import</span> anova_lm</span>
<span id="cb125-4"><a href="ANCOVA.html#cb125-4"></a>anova_lm(nonIpy,completpy)</span></code></pre></div>
<pre><code>   df_resid       ssr  df_diff   ss_diff         F    Pr(&gt;F)
0      14.0  4.222323      0.0       NaN       NaN       NaN
1      10.0  2.834009      4.0  1.388314  1.224691  0.360175</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="ANCOVA.html#cb127-1"></a><span class="co"># Test d&#39;absence de l&#39;effet de la covariable</span></span>
<span id="cb127-2"><a href="ANCOVA.html#cb127-2"></a>MTpy <span class="op">=</span> ols(<span class="st">&#39;FinalWeight ~  Treatment&#39;</span>, data<span class="op">=</span>oysterpy).fit()</span>
<span id="cb127-3"><a href="ANCOVA.html#cb127-3"></a>anova_lm(MTpy,nonIpy)</span></code></pre></div>
<pre><code>   df_resid         ssr  df_diff     ss_diff           F        Pr(&gt;F)
0      15.0  160.262500      0.0         NaN         NaN           NaN
1      14.0    4.222323      1.0  156.040177  517.383995  1.867369e-12</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="ANCOVA.html#cb129-1"></a><span class="co"># Test d&#39;absence de l&#39;effet du facteur</span></span>
<span id="cb129-2"><a href="ANCOVA.html#cb129-2"></a>Mzpy <span class="op">=</span> ols(<span class="st">&#39;FinalWeight ~  InitWeight&#39;</span>, data<span class="op">=</span>oysterpy).fit()</span>
<span id="cb129-3"><a href="ANCOVA.html#cb129-3"></a>anova_lm(Mzpy,nonIpy)</span></code></pre></div>
<pre><code>   df_resid        ssr  df_diff    ss_diff          F    Pr(&gt;F)
0      18.0  16.311683      0.0        NaN        NaN       NaN
1      14.0   4.222323      4.0  12.089359  10.021203  0.000482</code></pre>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="ANOVA.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="GLM.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Bookdown-poly.pdf", "Bookdown-poly.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
